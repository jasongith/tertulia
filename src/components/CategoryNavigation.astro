---
export interface Props {
  categories: string[];
  icons: Record<string, string>;
}

const { categories, icons } = Astro.props;
---

<nav
  class="sticky top-20 z-40 bg-white/90 backdrop-blur-md rounded-2xl mx-4 mb-6 p-4 shadow-lg border border-amber-200"
>
  <h3 class="text-amber-800 font-semibold text-sm mb-3 text-center">
    Ir a secci√≥n
  </h3>
  <div class="flex flex-wrap justify-center gap-2">
    {
      categories.map((category) => {
        const categoryId = category.toLowerCase().replace(/\s+/g, "-");
        return (
          <a
            href={`#${categoryId}`}
            class="group bg-gradient-to-r from-amber-100 to-orange-100 hover:from-amber-200 hover:to-orange-200 text-amber-800 px-3 py-2 rounded-xl text-xs font-medium transition-all duration-300 hover:scale-105 hover:shadow-md flex items-center gap-1"
          >
            <span class="group-hover:animate-bounce text-sm">
              {icons[category] || "üçΩÔ∏è"}
            </span>
            <span>{category}</span>
          </a>
        );
      })
    }
  </div>
</nav>

<style>
  /* Hide navigation when scrolling down, show when scrolling up */
  nav {
    transition: transform 0.3s ease-in-out;
  }

  @media (max-width: 640px) {
    nav {
      margin-left: 1rem;
      margin-right: 1rem;
    }
  }
</style>

<script>
  // Smart navigation hide/show behavior
  let lastScrollY = window.scrollY;
  let ticking = false;

  function updateNavigation() {
    const nav = document.querySelector("nav");
    const currentScrollY = window.scrollY;

    if (nav) {
      if (currentScrollY > lastScrollY && currentScrollY > 200) {
        // Scrolling down - hide nav
        nav.style.transform = "translateY(-100%)";
      } else {
        // Scrolling up - show nav
        nav.style.transform = "translateY(0)";
      }
    }

    lastScrollY = currentScrollY;
    ticking = false;
  }

  function onScroll() {
    if (!ticking) {
      requestAnimationFrame(updateNavigation);
      ticking = true;
    }
  }

  window.addEventListener("scroll", onScroll, { passive: true });
</script>
